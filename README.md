# MNIST-GPT

### Autocomplete for MNIST images

This repository demonstrates an autoregressive GPT model trained on the MNIST dataset to “autocomplete” pixel values in a 28×28 image. Instead of text, the model completes a sequence of 784 discrete pixel values (one token per pixel).

---

## GIF of a "4" Being Generated

Below is an example GIF illustrating how the digit “4” is generated pixel-by-pixel (with ungenerated pixels shown in light blue):

![Example generation of digit 4](./generations/gifs/4.gif)

*(If the GIF doesn’t display, make sure the path is correct or open the file locally.)*

---

## Samples

Below are sample images generated by the model for digits 0–9:

![Samples 0-9](./generations/imgs/0.png)
![Samples 0-9](./generations/imgs/1.png)
![Samples 0-9](./generations/imgs/2.png)
![Samples 0-9](./generations/imgs/3.png)
![Samples 0-9](./generations/imgs/4.png)
![Samples 0-9](./generations/imgs/5.png)
![Samples 0-9](./generations/imgs/6.png)
![Samples 0-9](./generations/imgs/7.png)
![Samples 0-9](./generations/imgs/8.png)
![Samples 0-9](./generations/imgs/9.png)

And here are the corresponding GIFs of the same digits being generated (if you ran with the `--generate_gifs` flag):

![GIF 0](./generations/gifs/0.gif)
![GIF 1](./generations/gifs/1.gif)
![GIF 2](./generations/gifs/2.gif)
![GIF 3](./generations/gifs/3.gif)
![GIF 4](./generations/gifs/4.gif)
![GIF 5](./generations/gifs/5.gif)
![GIF 6](./generations/gifs/6.gif)
![GIF 7](./generations/gifs/7.gif)
![GIF 8](./generations/gifs/8.gif)
![GIF 9](./generations/gifs/9.gif)

*(If the images/GIFs are missing, make sure the paths align with your directory structure.)*

---

## Usage

You can generate images from the command line using the `run.py` script. For example:

```bash
python run.py \
    --targets "0,1,2" \
    --temperature 1.2 \
    --top_k 50 \
    --generate_gifs
```



## Command-line Arguments

You can generate images from the command line using the `run.py` script. For example:

```bash
python run.py \
    --targets "0,1,2" \
    --temperature 1.2 \
    --top_k 50 \
    --generate_gifs
```

### Available Arguments

- `--targets`: Comma-separated list of digits to generate (e.g. `"0,1,2"`). By default, it generates `[0..9]`.
- `--temperature`: Adjusts the randomness of sampling. Defaults to `1.0`.
- `--top_k`: Use top-k sampling. For example, `--top_k 50` keeps the top 50 tokens. Defaults to `None`.
- `--top_p`: Use nucleus (top-p) sampling. For example, `--top_p 0.9` keeps tokens whose cumulative probability ≤ 0.9. Defaults to `None`.
- `--generate_gifs`: If set, also generate pixel-by-pixel GIFs for each digit. Defaults to off.




## Descriptions of Files

- **`mnist_gpt.py`**  
  This file defines the `GPT` model architecture specialized for MNIST pixel (token) generation. It includes any relevant modules (transformer blocks, positional embeddings, etc.).

- **`mnist_gpt_train.ipynb`**  
  Jupyter notebook used to train the GPT model on MNIST data. It likely includes data preprocessing, model initialization, training loops, etc.

- **`run.py`**  
  Command-line script that loads the trained GPT model (`trained_model_state_dict.pt`), accepts command-line arguments, generates digits, and saves outputs (PNGs and optionally GIFs).

- **`trained_model_state_dict.pt`**  
  The PyTorch state dictionary for the pre-trained GPT. This file contains all the learned weights.